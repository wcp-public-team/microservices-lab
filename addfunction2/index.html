<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Add another function - Microservices Lab</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Add another function";
    var mkdocs_page_input_path = "addfunction2.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Microservices Lab</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../signup/">Sign up for IBM Cloud</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../explore/">Explore IBM Cloud</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../createapp/">Create your first application</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../addfunction1/">Add logic to your application</a>
	    </li>
          
            <li class="toctree-l1 current">
		
    <a class="current" href="./">Add another function</a>
    <ul class="subnav">
            
    <li class="toctree-l2"><a href="#add-another-function">Add another function</a></li>
    

    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../apiexplorer/">Using the API Explorer</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../summary/">Summary</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../resources/">Additional Learning Resources</a>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Microservices Lab</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Add another function</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="add-another-function">Add another function</h1>
<p>So far there is one function in your microservice that returns a list of customers.  Nice work!  But there is more functionality that your microservice needs.  In this section you will perform steps similar to the last section to add a new function that returns a list of plans.</p>
<p>Click on the hamburger menu and click on <code>DevOps</code>.  Click on your toolchain, then click on the Orion Web IDE tile.</p>
<p>You should now be back in the web editor.  Right click on the <code>server</code> directory and create a new file named <code>plan.js</code>.</p>
<p>Copy and paste the code below into the file.</p>
<pre><code>exports.getPlans = function(req, res) {

    var plans = [
        {
            id: &quot;abc123&quot;,
            name: &quot;Gold&quot;,
            description: &quot;This is the Gold plan&quot;,
            premium: 328.49
        },
        {
            id: &quot;def456&quot;,
            name: &quot;Platinum&quot;,
            description: &quot;This is the Platinum plan&quot;,
            premium: 428.32
        },
        {
            id: &quot;ghj789&quot;,
            name: &quot;Silver&quot;,
            description: &quot;This is the Silver plan&quot;,
            premium: 287.46
        }
    ]

    res.json(plans);

}
</code></pre>

<p>Click on <code>myservice.js</code> in the left navigation menu to edit it.  You may have to expand the <code>routers</code> folder to see it.</p>
<p>Copy and replace <em><strong>all</strong></em> of the code in the file with the code below.</p>
<pre><code>var customer = require('../customer');
var plan = require('../plan');
module.exports = function(app){

    app.get(&quot;/customers&quot;, customer.getCustomers);
    app.get(&quot;/plans&quot;, plan.getPlans);
}
</code></pre>

<p>That's all of the code that needs to be added; now you need to commit and push it.  </p>
<p>Click on the icon that looks like the road sign on the left navigation bar.</p>
<p><img alt="" src="../images/OrionLeftNavGit.png" /></p>
<p>You will see that this time there are two files selected.  These are the files you just updated.  Enter a commit message and click the <code>Commit</code> button.</p>
<p><img alt="" src="../images/CommitChangesPlan.png" /></p>
<p>Now there should be an outgoing change.  Click the <code>Push</code> button to push your changes to the remote git repo in IBM Cloud.  Remember that this triggers your the build stage of your delivery pipeline!</p>
<p><img alt="" src="../images/PushChangesPlan.png" /></p>
<p>Click the back arrow on the left navigation toolbar to go back to the toolchain.</p>
<p><img alt="" src="../images/OrionLeftNavBack.png" /></p>
<p>Click on the Delivery Pipeline tile.  You should see that your deploy stage is still running.  Once it has passed you should be able to click on the URL for your app.  Remember that the default route is missing; this time add <code>/plans</code> to your URL and hit enter.</p>
<p><img alt="" src="../images/GetPlansResult.png" /></p>
<p>If you got some JSON back in your browser window then your code works!</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../apiexplorer/" class="btn btn-neutral float-right" title="Using the API Explorer">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../addfunction1/" class="btn btn-neutral" title="Add logic to your application"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../addfunction1/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../apiexplorer/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>

</body>
</html>
